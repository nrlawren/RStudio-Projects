---
title: "Principal Component Analysis"
output: html_notebook
---

## The data dictionary for the MTCARS data set in R

mpg: Fuel consumption (Miles per (US) gallon): more powerful and heavier cars tend   to consume more fuel.
cyl: Number of cylinders: more powerful cars often have more cylinders
disp: Displacement (cu.in.): the combined volume of the engine's cylinders
hp: Gross horsepower: this is a measure of the power generated by the car
drat: Rear axle ratio: this describes how a turn of the drive shaft corresponds to   a turn of the wheels. Higher values will decrease fuel efficiency.
wt: Weight (1000 lbs): pretty self-explanatory!
qsec: 1/4 mile time: the cars speed and acceleration
vs: Engine block: this denotes whether the vehicle's engine is shaped like a "V",   or is a more common straight shape.
am: Transmission: this denotes whether the car's transmission is automatic (0) or   manual (1).
gear: Number of forward gears: sports cars tend to have more gears.
carb: Number of carburetors: associated with more powerful engines


```{r}
library(tidyverse)
library(dplyr)
library(factoextra)
library(devtools)
library(ggbiplot)
```

## Exclude the two categorical variables

```{r}
mtcars_mod <- mtcars[,c(1:7,10,11)]
head(mtcars_mod)
```



## Run a principal component analysis on the modified data set

```{r}
mtcars_pca <- prcomp(mtcars_mod, center = TRUE, scale. = TRUE)
mtcars_pca
```

```{r}
summary(mtcars_pca)
```

```{r}
fviz_eig(mtcars_pca)
```


## Create plots

```{r}
ggbiplot(mtcars_pca)
```


***Plot above but with labels of cars***

```{r}
ggbiplot(mtcars_pca, labels = rownames(mtcars))
```


***Add in region***

```{r}
mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))
ggbiplot(mtcars_pca,ellipse=TRUE, labels=rownames(mtcars), groups=mtcars.country)
```


## Look at PC3 and PC4

```{r}
ggbiplot(mtcars_pca,ellipse=TRUE,choices=c(3,4), labels=rownames(mtcars), groups=mtcars.country)
```


## Correlation Matrix of the modified data

```{r}
mtcars_scaled <- scale(mtcars_mod, center = TRUE, scale = TRUE)
mtcars_corr <- round(cor(mtcars_scaled),2)
mtcars_corr
```


## Calculate the Eigenvalues and Eigenvectors

```{r}
mtcars_eig <- eigen(mtcars_corr)
mtcars_eig
```



# Transpose eigeinvectors

```{r}
eigenvectors.t <- t(mtcars_eig$vectors)
eigenvectors.t
```


# Transpose the adjusted data

```{r}
mtcars_scaled.t <- t(mtcars_scaled)
mtcars_scaled.t
```


# The new dataset

```{r}
mtcars_new <- eigenvectors.t %*% mtcars_scaled.t
mtcars_new
```


# Transpose new data ad rename columns

```{r}
mtcars_new <- t(mtcars_new)
colnames(mtcars_new) <- c("PC1", "PC2", "PC3", "PC4", "PC5", "PC6", "PC7", "PC8", "PC9")
mtcars_new
```


```{r}
cor(mtcars_new)
```






